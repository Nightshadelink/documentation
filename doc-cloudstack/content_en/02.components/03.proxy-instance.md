---
url: /components/proxy-instances/
next: /components/mobydick-instances/
prev: /components/management-ui/
title: Proxy Instances
keywords:
    - Proxy Instances
    - cloudstack Proxy
    - cloudstack Security
description: mobydick Instance services are never reachable directly, but rather are accessible only over a Proxy.
toc: true
weight: 03
---

mobydick Instance services are never reachable directly, but rather are accessible only over a Proxy.

This has two Benefits:

1. The Proxy acts as a security layer and only permits access to individual mobydick instances as authorised by you.

2. The Proxy requires only an IP address. All mobydick instances that lie "behind" the Proxy are addressable through entering the mobydick instance name.

## Number of Proxy Instances

A single Proxy is sufficient in order to access any number of mobydick instances.

You should use multiple proxies if you wish to setup numerous security zones.

For example, you could have a Proxy to direct access coming directly from the internet into the DMZ security zone plus operating an additional Proxy for your secure customer network and the modified the security requirements accrodingly for both proxies.

## Services

Each Proxy responsible for a range of services. The avaibility of individual services over a particular Proxy can be limited or completely deactivated.

### Telephony Services

A customer's IP telephones (both hardware and sotfware) will be registered per SIP on the corresponding mobydick Instance.

#### Configuration Options

| Field           | Option         | Description                              |
| -------------- | ---------------|------------------------------------------- |
| **VoIP SIP**   | TLS* | SIP only TCP+TLS on Port TCP `5061` |
|                | UDP | SIP only UDP on Port UDP `5060` |
|                | off | Deactivate SIP on this Proxy |
| **VoIP media** | SRTP* | Encrypt voice data over Ports UDP `30000-35000` |
|                | RTP | Do not encrypt voice data over Ports UDP `30000-35000`|
\* Default Settings

### Provisioning Services

The IP telephones from supported vendors can be automatically configured (provisioned) by the individual mobydick instances.

In order to provision a IP phone device, a URL will be generated from which the configurations can be downloaded. This needs to be either manually copied onto the device or transmitted to the device per DHCP.

The whole service is regulated via the field **Phone Provisioning** and recognizes the following modes:

#### HTTPS only, Encrypted URL ####

This is the standard defaul mode. It is not intended for untrust worthy environments such as the internet. The URL which is generate per device is structured as follows::

**Scheme**
```
https://[ip_or_proxy_dns_name]:8884/p/[encrypted_URL]
```

**Example**
```
https://mobydick.example.com:8884/p/BnFkLayY-XthMu-W89wHu04ftBnmwKFfCWce_p97Tog=%2B
```

From this URL, it is not possible to decipher for which mobydick instance nor which telephone the request is intended for. As a unique key is generated for each telephone individually, this mode is only intended for the manual copying of the URL to the telephone and is not suitable for distribution per DHCP.

##### Encrypting the URL #####

The URL encryption is done using the key as specified in the field **Provisioning key**.

{{% notice tip %}}
Should you want to change the key, all your previously generated provisioning URLs will become invalid and will need to be regenerated and redistributed to the telephones! Therefore, it is recommended to make a backup of every Proxy as this will also save all your certificates and encryption keys.
{{% /notice %}}

#### HTTPS only ####

Use the trusted mode only when you can trust the network. For example, when the Proxy is located in your local or in a customer's private network.

In this mode the URL is structured as follows:

**Scheme**
```
https://[ip_or_proxy_dns_name]:8884/p/[mobydick-instancename]/[telephone-mac-address]
```

**Example**
```
https://mobydick.example.com:8884/p/mycompany/08C25A4F0321
```

The mobydick Instance name as well as the telephone MAC Address are in identifiable in the URL whilst in this mode. Therefore, this URL can be used in combination with the per DHCP distribution option as manay phone devices automatically attach the MAC address on to the URL or by using an appropriate parameters

#### HTTP and HTTPS ####

As with **HTTPS only** but also with unencrypted http on Port TCP `8880`.
Example:

**Scheme**
```
http://[ip_oder_dns_name_des_proxy]:8880/p/[mobydick-instancename]/[telephone-mac-address]
```

**Example**
```
http://mobydick.example.com:8880/p/mycompany/08C25A4F0321
```

#### Off ####

Completely switch off the provisioning services for this Proxy Instance.

### XMPP Services

The mobydick desktop and mobile clients use XMPP for presence management, chat and remote controlling of numerous functions.

The field **Allow Client (XMPP) Connections** switches these services on the corresponding Proxy either on or off.

### mobydick Web UI

Each mobydick Instance has it's own Management UI. Through the **Manage mobydick Instances** field, you can control whether the management UIs are reachable via (**HTTPS Web-UI and REST**), only by REST-Services (**HTTPS REST only**) or completely switched (**Off**).

Access to the individual Management UIs can be gained through the following URL:

**Scheme**
```
https://[ip_or_proxy_dns_name]/[mobydick-instancename]
```

**Example**
```
https://mobydick.example.com/mycompany
```

Access to the mobydick instance REST-Services is granted via the following URL:

**Scheme**
```
https://[ip_or_proxy_dns_name]/[mobydick-instancename]/services
```

**Example**
```
https://mobydick.example.com/mycompany/services
```

More information regarding managing individual mobydick instances and REST services can be found in the mobydick documentation.

## Network Settings

Each Proxy Instance has two different network modes at its disposal, which can be set in the field **Network mode**.

{{% notice tip %}}
It is not subsequently possible to change the network mode. However, it is possible to create a new Proxy to replace the existing Proxy.
{{% /notice %}}

### auto

auto is the default mode. Only and Proxy can have this mode. All Proxy services will be automatically bound to the first network card (`eth0`).

### manual

This mode provides you with the option to bind a Proxy instance to any number of network cards (not `eth0`, see **auto**).

The network cards will be exclusively managed by this Proxy and can therefore not be used for anything else. The following settings are possible:

| Field | Description | Example |
| --- | --- | --- |
| **Network Interface** | Network Card Name | `eth1` |
| **Network IP-Address** | IP Address | `10.5.6.100` |
| **Network Netmask** | Netmask | `255.255.255.0` |
| **Network Gateway** | Standard Gateway | `10.5.6.254` |

{{% notice tip %}}
Each Proxy has its own Routing Table. It is therefore possible to configure a different Standard Gateway for each Proxy.
{{% /notice %}}

## Additional Proxy Settings

### Proxy DNS Name (FQDN)

Witin the field **Proxy DNS Name (FQDN)**, please enter the DNS Name under which this Proxy is accessible e. g. `mobydick.example.com`. Alternatively, you can also enter the Proxy's IP Address.

This field is used for (amongst other things) generating the Provisioning URLs:

**Exampel**
```
https://mobydick.example.com:8884/p/BnFkLayY-XthMu-W89wHu04ftBnmwKFfCWce_p97Tog=%2B

```

### Certificate

In the fields **Certificate PEM** and **Certificate Key** you will need to add an official certificate for signing or the URL entered under **Proxy DNS Name (FQDN)**.

As standard, a "self signed" certificate is added here. As long as this is not replaced by an official certificate, the browsers used to access the individual mobydick instances' management UIs will report security concerns with the access URLs.

### Redirection URL

The Proxy DNS name will be known to end users in that it will be required for logging into the mobydick desktop and mobile clients.

Administrators will also use the same name followed by their mobydick instance name in order to access their instance management UI:

```
https://mobydick.example.com/mycompany
```

Now it stands to reason that you can offer additional documentation / advertising for your mobydick hosting services on `https://mobydick.example.com`.

That the Proxy URL does not direct to a website, it is possible to route requests to a website usings the field **Redirection URL**. For example, you could route requests to:
`https://mobydick.example.com` e.g to you website
`https://www.example.com/why_mobydick_is_so_cool.html` or your mobydick hosting landing page.

## Backup and Restore

At the bottom of the Proxy Details page, you have the option to create a backup of the Proxy.
To create a backup, the Proxy muss be activated / switched on.

A Proxy does not have any dynamic data. That means the backup will only store the settings such as keys as well as your certificates.

Backups also only make sense after modifying your configurations.

{{% notice tip %}}
We recommend that you download your cloudstack backup and store it in a secure location.
{{% /notice %}}

In order to restore a backup, the Proxy must be switched off.
