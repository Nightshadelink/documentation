---
url: /komponenten/proxy-instanzen/
next: /komponenten/mobydick-instanzen/
prev: /komponenten/management-ui/
title: Proxy Instanzen
keywords:
    - Proxy Instanzen
    - cloudstack Proxy
    - cloudstack Sicherheit
description: Die Dienste der mobydick Instanzen sind niemals direkt, sondern immer nur über einen Proxy erreichbar.
toc: true
weight: 03

---

Die Dienste der mobydick Instanzen sind niemals direkt, sondern immer nur über
einen Proxy erreichbar.

Dies hat zwei Vorteile:

1. Der Proxy dient als Sicherheitsschicht und lässt nur den von Ihnen gewünschten
Zugriff auf die einzelnen mobydick Instanzen zu.

2. Der Proxy benötigt nur eine IP-Adresse. Alle "dahinter" liegenden mobydick
Instanzen sind durch Angabe des mobydick Instanz Namen adressierbar.

## Anzahl Proxy Instanzen

Es genügt ein einziger Proxy um auf beliebig viele mobydick Instanzen zugreifen
zu können.

Verwenden Sie mehrere Proxies falls Sie verschiedene Sicherheitsbereiche
einrichten wollen.

Beispielsweise können Sie einen Proxy für Zugriffe aus dem Internet in der DMZ
platzieren und einen weiteren Proxy in Ihrem gesicherten Kundennetzwerk
betreiben und die Sicherheitsanforderungen entsprechend anpassen.

## Dienste

Jeder Proxy ist für eine Reihe an Diensten zuständig. Die Verfügbarkeit der
einzelnen Dienste über den jeweiligen Proxy kann eingeschränkt bzw. ganz
deaktiviert werden.

### Telefonie-Dienst

Die IP-Telefone der Kunden (egal ob Hard- oder Software) werden per SIP direkt
an der jeweiligen mobydick Instanz angemeldet.

#### Konfigurations-Optionen

| Feld           | Option         | Beschreibung                               |
| -------------- | ---------------|------------------------------------------- |
| **VoIP SIP**   | TLS* | SIP nur TCP+TLS auf Port TCP `5061` |
|                | UDP | SIP nur UDP auf Port UDP `5060` |
|                | off | SIP auf diesem Proxy deaktivieren |
| **VoIP media** | SRTP* | Sprachdaten verschlüsseln über Ports UDP `30000-35000` |
|                | RTP | Sprachdaten nicht verschlüsseln über Ports UDP `30000-35000`|
\* Standardeinstellung

### Provisionierungs-Dienst

Die IP-Telefone unterstützer Hersteller können von den einzelnen mobydick
Instanzen automatisch konfiguriert (provisioniert) werden.

Um ein Gerät zu provisionieren wird diesem einem URL bereit gestellt von der
es die Konfiguration herunter laden kann. Diese URL wird entweder manuell
auf das Gerät kopiert oder per DHCP-Option an das Gerät übergeben.

Der gesamte Dienst wird über das Feld **Phone Provisioning** geregelt
und kennt folgende Modi:

#### HTTPS only, encrypted URL ####

Dies ist der Standradmäßig voreingestellt Modus. Er ist für nicht
vertrauenswürdige Umgebungen wie das Internet geeignet. Die pro Gerät erzeugte
URL hat folgenden Aufbau:

**Schema**
```
https://[ip_oder_dns_name_des_proxy]:8884/p/[verschlüsselte_url]
```

**Beispiel**
```
https://mobydick.example.com:8884/p/BnFkLayY-XthMu-W89wHu04ftBnmwKFfCWce_p97Tog=%2B
```

Aus dieser URL lässt sich weder ableiten für welche mobydick Instanz noch für
welches Telefon diese Anfrage bestimmt ist. Da dieser Schlüssel für jedes
Telefon einzeln erzeugt wird eignet sich dieser Modus nur für das manuelle
Kopieren der URL auf das Telefon nicht aber für die Verteilung per DHCP.

##### Verschlüsselung der URL #####

Die Verschlüsselung der URL erfolgt mit dem in Feld **Provisioning key**
angegebenem Schlüssel.

{{% notice tip %}}
Wenn Sie diesen Key ändern werden alle zuvor erstellen Provisionierungs-URLs
ungültig und müssen neu an die Telefone verteilt werden! Außerdem empfiehlt es
sich ein Backup jedes Proxies zu erstellen. Unter anderem werden hier Zertifikate
und Schlüssel gespeichert.
{{% /notice %}}

#### HTTPS only ####

Verwenden Sie den trusted Modus wenn Sie dem Netzwerk vertrauen können. Z. B.
wenn sich der Proxy in Ihrem lokalen oder einem privaten Kundennetzwerk
befindet.

In diesem Modus ist die URL wie folgt:

**Schema**
```
https://[ip_oder_dns_name_des_proxy]:8884/p/[mobydick-instanzname]/[mac-adresse-des-telefones]
```

**Beispiel**
```
https://mobydick.example.com:8884/p/mycompany/08C25A4F0321
```

Der mobydick Instanzname sowie die MAC-Adresse des Telefones sind in diesem
Modus in der URL erkennbar. Dafür lässt sich diese URL einfach per DHCP-Option
verteilen da viele Endgeräte die eigene MAC-Adresse an die URL automatisch oder
durch Angabe eines entsprechenden Parameters anhängen.

#### HTTP and HTTPS ####

Wie **HTTPS only** nur zusätzlich per http unverschlüsselt auf Port TCP `8880`.
Beispiel:

**Schema**
```
http://[ip_oder_dns_name_des_proxy]:8880/p/[mobydick-instanzname]/[mac-adresse-des-telefones]
```

**Beispiel**
```
http://mobydick.example.com:8880/p/mycompany/08C25A4F0321
```

#### Off ####

Schaltet den Provisionierungs-Dienst für diese Proxy-Instanz komplett ab.

### XMPP-Dienst

Die mobydick Desktop- und Mobile-Clients verwenden XMPP unter anderem für
Präsenzmanagement, Chat und Fernsteuerung zahlreicher Funktionen.

Das Feld **Allow Client (XMPP) Connections** schaltet diesen auf dem jeweiligen
Proxy aus bzw. an.

### mobydick Web-UI

Jede mobydick Instanz hat zur Verwaltung ein eigenes Management-UI. Durch das
Feld **Manage mobydick Instances** bestimmen Sie ob die Management-UIs
über den jeweiligen Proxy erreichbar sind (**HTTPS Web-UI and REST**), nur die
REST-Services (**HTTPS REST only**) oder abgeschaltet sind (**Off**).

Zugriff auf die Management-UIs der einzelnen mobydick Instanzen erhalten Sie
durch folgenden URL:

**Schema**
```
https://[ip_oder_dns_name_des_proxy]/[mobydick-instanzname]
```

**Beispiel**
```
https://mobydick.example.com/mycompany
```

Zu den REST-Services der einzelnen mobydick Instanzen gelangen Sie über die URL:

**Schema**
```
https://[ip_oder_dns_name_des_proxy]/[mobydick-instanzname]/services
```

**Beispiel**
```
https://mobydick.example.com/mycompany/services
```

Mehr über die Verwaltung der einzelnen mobydick Instanzen und REST Services
erfahren Sie in der mobydick Dokumentation.

## Netzwerk Einstellungen

Für jede Proxy-Instanz stehen zwei verschiedene Netzwerk-Modi zu Verfügung die
im Feld **Network mode** eingestellt werden können.

{{% notice tip %}}
Es ist nachträglich nicht möglich den Netzwerk-Modus zu verändern. Es besteht
jedoch die Möglichkeit einen neuen Proxy zu erstellen der den vorhandenen
ersetzt.
{{% /notice %}}

### auto

auto ist der Standard-Modus. Nur ein Proxy kann diesen Modus haben. Alle
Dienste dieses Proxies werden automatisch auf die erste Netzwerkkarte (`eth0`)
gebunden.

### manual

Dieser Modus bietet Ihnen die Möglichkeit eine Proxy-Instanz auf eine beliebige,
weitere Netzwerkkarte zu binden (nicht `eth0`, siehe **auto**).

Die Netzwerkkarte wird exklusiv von diesem Proxy verwaltet und kann daher für
nichts anderes verwendet werden. Folgende Einstellungen sind möglich:

| Feld | Beschreibung | Beispiel |
| --- | --- | --- |
| **Network Interface** | Name der Netzwerkkarte | `eth1` |
| **Network IP-Address** | IP-Adresse | `10.5.6.100` |
| **Network Netmask** | Netzmaske | `255.255.255.0` |
| **Network Gateway** | Standard Gateway | `10.5.6.254` |

{{% notice tip %}}
Jeder Proxy hat seine eigene Routing-Tabelle. Es ist daher möglich in jedem Proxy
ein eigenes Standard Gateway zu konfigurieren.
{{% /notice %}}

## Weitere Proxy Einstellungen

### Proxy DNS Name (FQDN)

Tragen Sie in das Feld **Proxy DNS Name (FQDN)** den DNS-Namen ein unter dem
dieser Proxy erreichbar ist. Z. B. `mobydick.example.com`. Alternativ können
Sie auch die IP-Adresse des Proxy eintragen.

Dieses Feld wird unter anderem bei der Generierung der Provisionierungs-URLs
verwendet:

**Beispiel**
```
https://mobydick.example.com:8884/p/BnFkLayY-XthMu-W89wHu04ftBnmwKFfCWce_p97Tog=%2B

```

### Zertifikat

In den Feldern **Certificate PEM** und **Certificate Key** hinterlegen Sie
ein offizielles Zertifikat für die Signierung der unter
**Proxy DNS Name (FQDN)** angegebenen URL.

Standardmäßig ist hier ein "self signed"-Zertifikat hinterlegt. Solange Sie
dieses nicht durch ein offizielles Zertifikat tauschen, wird der Browser, der auf die Management-UIs der einzelnen mobydick Instanzen zugreift Sicherheitsbedenken anmelden.

### Redirection URL

Der DNS-Name eines Proxy ist den Endbenutzern bekannt da sie diesen z. B. zur
Anmeldung am mobydick Desktop- oder Mobile-Client benötigen.

Administratoren Nutzen den selben Namen, gefolgt vom mobydick Instanznamen um
auf das Management-UI zuzugreifen:

```
https://mobydick.example.com/mycompany
```

Jetzt liegt es nahe z. B. die Dokumentation oder Werbung für Ihr mobydick Hosting
auf `https://mobydick.example.com` anzubieten.

Da der Proxy selbst unter dieser URL keine Webseite ausliefern wird ist es durch
das Feld **Redirection URL** möglich, Anfragen an
`https://mobydick.example.com` z. B. zu Ihrem Webauftritt
`https://www.example.com/why_mobydick_is_so_cool.html` weiter zu leiten.

## Backup und Restore

Am Ende der Proxy Detail-Seite haben Sie die Möglichkeit ein Backup zu erstellen.
Zur Erstellung eines Backup muss der Proxy eingeschaltet sein.

Ein Proxy hat keine Bewegungsdaten. Gesichert werden also nur die Einstellungen
sowie Keys und Zertifikate.

Backups machen also nur nach Konfigurations-Änderungen Sinn.

{{% notice tip %}}
Wir empfehlen Ihnen das Backup vom cloudstack herunter zu laden und
an einem sicheren Ort abzulegen.
{{% /notice %}}

Für das Einspielen eines Backups muss der Proxy ausgeschaltet sein.
